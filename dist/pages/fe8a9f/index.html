<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>20、多文件项目 | Richard&#39;s blog</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="https://cdn.jsdelivr.net/gh/Richard-LiSR/PicBed/blog_img/yhy_1.ico">
    <link rel="manifest" href="/vuepress_blog/manifest.json">
    <link rel="blog-icon" href="/vuepress_blog/icon-192x192.png">
    <meta name="description" content="这是一个简单的个人博客，目前还在开发中">
    <meta name="keywords" content="这是一个还未开发完全的博客">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="msapplication-TileColor" content="#000000">
    <link rel="preload" href="/vuepress_blog/assets/css/0.styles.f7ee0e6a.css" as="style"><link rel="preload" href="/vuepress_blog/assets/js/app.ba4d12ab.js" as="script"><link rel="preload" href="/vuepress_blog/assets/js/3.5f960c14.js" as="script"><link rel="preload" href="/vuepress_blog/assets/js/30.6989e660.js" as="script"><link rel="preload" href="/vuepress_blog/assets/js/5.8ee74237.js" as="script"><link rel="prefetch" href="/vuepress_blog/assets/js/10.b62cc3f1.js"><link rel="prefetch" href="/vuepress_blog/assets/js/11.81c1b460.js"><link rel="prefetch" href="/vuepress_blog/assets/js/12.99453db1.js"><link rel="prefetch" href="/vuepress_blog/assets/js/13.74ff9676.js"><link rel="prefetch" href="/vuepress_blog/assets/js/14.302795ce.js"><link rel="prefetch" href="/vuepress_blog/assets/js/15.ec4400d2.js"><link rel="prefetch" href="/vuepress_blog/assets/js/16.ec553d3b.js"><link rel="prefetch" href="/vuepress_blog/assets/js/17.1bcbf5dc.js"><link rel="prefetch" href="/vuepress_blog/assets/js/18.b35060fd.js"><link rel="prefetch" href="/vuepress_blog/assets/js/19.e6216dcb.js"><link rel="prefetch" href="/vuepress_blog/assets/js/20.4d75808e.js"><link rel="prefetch" href="/vuepress_blog/assets/js/21.0e9d9ebd.js"><link rel="prefetch" href="/vuepress_blog/assets/js/22.3d38d908.js"><link rel="prefetch" href="/vuepress_blog/assets/js/23.3627fbbf.js"><link rel="prefetch" href="/vuepress_blog/assets/js/24.f35e0bb0.js"><link rel="prefetch" href="/vuepress_blog/assets/js/25.d76e3ff5.js"><link rel="prefetch" href="/vuepress_blog/assets/js/26.ec41c3d5.js"><link rel="prefetch" href="/vuepress_blog/assets/js/27.b5faabc9.js"><link rel="prefetch" href="/vuepress_blog/assets/js/28.faa3ed6d.js"><link rel="prefetch" href="/vuepress_blog/assets/js/29.3fe7391f.js"><link rel="prefetch" href="/vuepress_blog/assets/js/31.7edbe166.js"><link rel="prefetch" href="/vuepress_blog/assets/js/32.7d39af3a.js"><link rel="prefetch" href="/vuepress_blog/assets/js/33.b8773975.js"><link rel="prefetch" href="/vuepress_blog/assets/js/34.6ff123fc.js"><link rel="prefetch" href="/vuepress_blog/assets/js/35.2ca5e222.js"><link rel="prefetch" href="/vuepress_blog/assets/js/36.1ff7dfaa.js"><link rel="prefetch" href="/vuepress_blog/assets/js/37.53bc09e1.js"><link rel="prefetch" href="/vuepress_blog/assets/js/38.4afa1b16.js"><link rel="prefetch" href="/vuepress_blog/assets/js/39.84e18610.js"><link rel="prefetch" href="/vuepress_blog/assets/js/4.4d96b94a.js"><link rel="prefetch" href="/vuepress_blog/assets/js/40.da3972ed.js"><link rel="prefetch" href="/vuepress_blog/assets/js/41.28fabbfe.js"><link rel="prefetch" href="/vuepress_blog/assets/js/42.f99bb255.js"><link rel="prefetch" href="/vuepress_blog/assets/js/6.c4ebe0ae.js"><link rel="prefetch" href="/vuepress_blog/assets/js/7.cb768440.js"><link rel="prefetch" href="/vuepress_blog/assets/js/8.edaa198a.js"><link rel="prefetch" href="/vuepress_blog/assets/js/9.3411675b.js"><link rel="prefetch" href="/vuepress_blog/assets/js/vendors~docsearch.e5cbbbd0.js">
    <link rel="stylesheet" href="/vuepress_blog/assets/css/0.styles.f7ee0e6a.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu have-body-img"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress_blog/" class="home-link router-link-active"><img src="/vuepress_blog/img/yhy_logo2.png" alt="Richard's blog" class="logo"> <span class="site-name can-hide">Richard's blog</span></a> <div class="links"><form id="search-form" role="search" class="algolia-search-wrapper search-box"><input id="algolia-search-input" class="search-query"></form> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress_blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨‍💻前端" class="dropdown-title"><a href="/vuepress_blog/web/" class="link-title">👨‍💻前端</a> <span class="title" style="display:none;">👨‍💻前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/8143cc480faf9a11/" class="nav-link">Vue</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨🏻‍💻技术" class="dropdown-title"><a href="/vuepress_blog/technology/" class="link-title">👨🏻‍💻技术</a> <span class="title" style="display:none;">👨🏻‍💻技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/0b36bc/" class="nav-link">C语言教程</a></li><li class="dropdown-subitem"><a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">python语言教程</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/d78202/" class="nav-link">mysql整理</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨🏻‍🔬机器学习" class="dropdown-title"><a href="/vuepress_blog/machine/" class="link-title">👨🏻‍🔬机器学习</a> <span class="title" style="display:none;">👨🏻‍🔬机器学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">pytorch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vuepress_blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">高等数学</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vuepress_blog/about/" class="nav-link">🧑🏻‍💻关于</a></div><div class="nav-item"><a href="/vuepress_blog/pages/beb6c0bd8a66cea6/" class="nav-link">解忧杂货店</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress_blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Richard-LiSR/Vue_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="https://cdn.jsdelivr.net/gh/Richard-LiSR/PicBed/blog_img/blog-author.jpg"> <div class="blogger-info"><h3>Richard_Li</h3> <span>程序猿届的小学生一枚!</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/vuepress_blog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨‍💻前端" class="dropdown-title"><a href="/vuepress_blog/web/" class="link-title">👨‍💻前端</a> <span class="title" style="display:none;">👨‍💻前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>前端文章</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/8143cc480faf9a11/" class="nav-link">Vue</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨🏻‍💻技术" class="dropdown-title"><a href="/vuepress_blog/technology/" class="link-title">👨🏻‍💻技术</a> <span class="title" style="display:none;">👨🏻‍💻技术</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>编程语言</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/0b36bc/" class="nav-link">C语言教程</a></li><li class="dropdown-subitem"><a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">python语言教程</a></li></ul></li><li class="dropdown-item"><h4>数据库</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/vuepress_blog/pages/d78202/" class="nav-link">mysql整理</a></li></ul></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="👨🏻‍🔬机器学习" class="dropdown-title"><a href="/vuepress_blog/machine/" class="link-title">👨🏻‍🔬机器学习</a> <span class="title" style="display:none;">👨🏻‍🔬机器学习</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">pytorch</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="更多" class="dropdown-title"><a href="/vuepress_blog/more/" class="link-title">更多</a> <span class="title" style="display:none;">更多</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/fe8a9f/.html" class="nav-link">高等数学</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/pages/2d615df9a36a98ed/" class="nav-link">心情杂货</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/friends/" class="nav-link">友情链接</a></li></ul></div></div><div class="nav-item"><a href="/vuepress_blog/about/" class="nav-link">🧑🏻‍💻关于</a></div><div class="nav-item"><a href="/vuepress_blog/pages/beb6c0bd8a66cea6/" class="nav-link">解忧杂货店</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="索引" class="dropdown-title"><a href="/vuepress_blog/archives/" class="link-title">索引</a> <span class="title" style="display:none;">索引</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vuepress_blog/categories/" class="nav-link">分类</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/tags/" class="nav-link">标签</a></li><li class="dropdown-item"><!----> <a href="/vuepress_blog/archives/" class="nav-link">归档</a></li></ul></div></div> <a href="https://github.com/Richard-LiSR/Vue_blog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>编程语言</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>C语言教程</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress_blog/pages/0b36bc/" class="sidebar-link">1、基本介绍</a></li><li><a href="/vuepress_blog/pages/980fa1/" class="sidebar-link">2、基本语法</a></li><li><a href="/vuepress_blog/pages/0a09f8/" class="sidebar-link">3、变量</a></li><li><a href="/vuepress_blog/pages/c17137/" class="sidebar-link">4、运算符</a></li><li><a href="/vuepress_blog/pages/da8ccc/" class="sidebar-link">5、流程控制</a></li><li><a href="/vuepress_blog/pages/960178/" class="sidebar-link">6、数据类型</a></li><li><a href="/vuepress_blog/pages/2e777b/" class="sidebar-link">7、指针</a></li><li><a href="/vuepress_blog/pages/228067/" class="sidebar-link">8、函数</a></li><li><a href="/vuepress_blog/pages/ec259b/" class="sidebar-link">9、数组</a></li><li><a href="/vuepress_blog/pages/0ded22/" class="sidebar-link">10、字符串</a></li><li><a href="/vuepress_blog/pages/b63b5a/" class="sidebar-link">11、struct结构</a></li><li><a href="/vuepress_blog/pages/d93d13/" class="sidebar-link">13、typedef 命令</a></li><li><a href="/vuepress_blog/pages/5a4bcd/" class="sidebar-link">14、Union 结构</a></li><li><a href="/vuepress_blog/pages/996325/" class="sidebar-link">15、Enum 类型</a></li><li><a href="/vuepress_blog/pages/7c0a49/" class="sidebar-link">16、预处理器</a></li><li><a href="/vuepress_blog/pages/1cf86e/" class="sidebar-link">17、IO 函数</a></li><li><a href="/vuepress_blog/pages/853264/" class="sidebar-link">18、文件操作</a></li><li><a href="/vuepress_blog/pages/dd8b65/" class="sidebar-link">19、变量说明符</a></li><li><a href="/vuepress_blog/pages/fe8a9f/" aria-current="page" class="active sidebar-link">20、多文件项目</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#简介" class="sidebar-link">简介</a></li><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#重复加载" class="sidebar-link">重复加载</a></li><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#extern-说明符" class="sidebar-link">extern 说明符</a></li><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#static-说明符" class="sidebar-link">static 说明符</a></li><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#编译策略" class="sidebar-link">编译策略</a></li><li class="sidebar-sub-header"><a href="/vuepress_blog/pages/fe8a9f/#make-命令" class="sidebar-link">make 命令</a></li></ul></li><li><a href="/vuepress_blog/pages/f9b963/" class="sidebar-link">21、命令行环境</a></li><li><a href="/vuepress_blog/pages/e90699/" class="sidebar-link">22、多字节字符</a></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>python教程</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-70a2d273><div class="articleInfo" data-v-70a2d273><ul class="breadcrumbs" data-v-70a2d273><li data-v-70a2d273><a href="/vuepress_blog/" title="首页" class="iconfont icon-home router-link-active" data-v-70a2d273></a></li> <li data-v-70a2d273><a href="/vuepress_blog/technology" title="技术-目录页" data-v-70a2d273>技术</a></li> <li data-v-70a2d273><a href="/vuepress_blog/technology/#编程语言" title="技术#编程语言" data-v-70a2d273>编程语言</a></li> <li data-v-70a2d273><a href="/vuepress_blog/technology/#C语言教程" title="技术#C语言教程" data-v-70a2d273>C语言教程</a></li></ul> <div class="info" data-v-70a2d273><div title="作者" class="author iconfont icon-touxiang" data-v-70a2d273><a href="https://github.com/Richard-LiSR" target="_blank" title="作者" class="beLink" data-v-70a2d273>Richard_Li</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-70a2d273><a href="javascript:;" data-v-70a2d273>2021-09-17</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-content"></div></div></div> <h1><img src="https://cdn.jsdelivr.net/gh/Richard-LiSR/PicBed/blog_img/yhy_10.ico">
          20、多文件项目
        </h1> <!----> <div class="theme-vdoing-content content__default"><p>一个软件项目往往包含多个源码文件，编译时需要将这些文件一起编译，生成一个可执行文件。
</p> <h1 id="多文件项目"><a href="#多文件项目" class="header-anchor">#</a> 多文件项目</h1> <h2 id="简介"><a href="#简介" class="header-anchor">#</a> 简介</h2> <p>一个软件项目往往包含多个源码文件，编译时需要将这些文件一起编译，生成一个可执行文件。</p> <p>假定一个项目有两个源码文件<code>foo.c</code>和<code>bar.c</code>，其中<code>foo.c</code>是主文件，<code>bar.c</code>是库文件。所谓“主文件”，就是包含了<code>main()</code>函数的项目入口文件，里面会引用库文件定义的各种函数。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File foo.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5!</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>上面代码中，主文件<code>foo.c</code>调用了函数<code>add()</code>，这个函数是在库文件<code>bar.c</code>里面定义的。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File bar.c</span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> x<span class="token punctuation">,</span> <span class="token keyword">int</span> y<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> x <span class="token operator">+</span> y<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>现在，将这两个文件一起编译。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ gcc -o foo foo.c bar.c

<span class="token comment"># 更省事的写法</span>
$ gcc -o foo *.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>上面命令中，gcc 的<code>-o</code>参数指定生成的二进制可执行文件的文件名，本例是<code>foo</code>。</p> <p>这个命令运行后，编译器会发出警告，原因是在编译<code>foo.c</code>的过程中，编译器发现一个不认识的函数<code>add()</code>，<code>foo.c</code>里面没有这个函数的原型或者定义。因此，最好修改一下<code>foo.c</code>，在文件头部加入<code>add()</code>的原型。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File foo.c</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5!</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>现在再编译就没有警告了。</p> <p>你可能马上就会想到，如果有多个文件都使用这个函数<code>add()</code>，那么每个文件都需要加入函数原型。一旦需要修改函数<code>add()</code>（比如改变参数的数量），就会非常麻烦，需要每个文件逐一改动。所以，通常的做法是新建一个专门的头文件<code>bar.h</code>，放置所有在<code>bar.c</code>里面定义的函数的原型。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File bar.h</span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>然后使用<code>include</code>命令，在用到这个函数的源码文件里面加载这个头文件<code>bar.h</code>。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File foo.c</span>

<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;bar.h&quot;</span></span>

<span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">void</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;%d\n&quot;</span><span class="token punctuation">,</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 5!</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上面代码中，<code>#include &quot;bar.h&quot;</code>表示加入头文件<code>bar.h</code>。这个文件没有放在尖括号里面，表示它是用户提供的；它没有写路径，就表示与当前源码文件在同一个目录。</p> <p>然后，最好在<code>bar.c</code>里面也加载这个头文件，这样可以让编译器验证，函数原型与函数定义是否一致。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File bar.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&quot;bar.h&quot;</span></span>

<span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>现在重新编译，就可以顺利得到二进制可执行文件。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ gcc -o foo foo.c bar.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><h2 id="重复加载"><a href="#重复加载" class="header-anchor">#</a> 重复加载</h2> <p>头文件里面还可以加载其他头文件，因此有可能产生重复加载。比如，<code>a.h</code>和<code>b.h</code>都加载了<code>c.h</code>，然后<code>foo.c</code>同时加载了<code>a.h</code>和<code>b.h</code>，这意味着<code>foo.c</code>会编译两次<code>c.h</code>。</p> <p>最好避免这种重复加载，虽然多次定义同一个函数原型并不会报错，但是有些语句重复使用会报错，比如多次重复定义同一个 Struct 数据结构。解决重复加载的常见方法是，在头文件里面设置一个专门的宏，加载时一旦发现这个宏存在，就不再继续加载当前文件了。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token comment">// File bar.h</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">BAR_H</span></span>
  <span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">BAR_H</span></span>
  <span class="token keyword">int</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">,</span> <span class="token keyword">int</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面示例中，头文件<code>bar.h</code>使用<code>#ifndef</code>和<code>#endif</code>设置了一个条件判断。每当加载这个头文件时，就会执行这个判断，查看有没有设置过宏<code>BAR_H</code>。如果设置过了，表明这个头文件已经加载过了，就不再重复加载了，反之就先设置一下这个宏，然后加载函数原型。</p> <h2 id="extern-说明符"><a href="#extern-说明符" class="header-anchor">#</a> extern 说明符</h2> <p>当前文件还可以使用其他文件定义的变量，这时要使用<code>extern</code>说明符，在当前文件中声明，这个变量是其他文件定义的。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">extern</span> <span class="token keyword">int</span> myVar<span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面示例中，<code>extern</code>说明符告诉编译器，变量<code>myvar</code>是其他脚本文件声明的，不需要在这里为它分配内存空间。</p> <p>由于不需要分配内存空间，所以<code>extern</code>声明数组时，不需要给出数组长度。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">extern</span> <span class="token keyword">int</span> a<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>这种共享变量的声明，可以直接写在源码文件里面，也可以放在头文件中，通过<code>#include</code>指令加载。</p> <h2 id="static-说明符"><a href="#static-说明符" class="header-anchor">#</a> static 说明符</h2> <p>正常情况下，当前文件内部的全局变量，可以被其他文件使用。有时候，不希望发生这种情况，而是希望某个变量只局限在当前文件内部使用，不要被其他文件引用。</p> <p>这时可以在声明变量的时候，使用<code>static</code>关键字，使得该变量变成当前文件的私有变量。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code><span class="token keyword">static</span> <span class="token keyword">int</span> foo <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面示例中，变量<code>foo</code>只能在当前文件里面使用，其他文件不能引用。</p> <h2 id="编译策略"><a href="#编译策略" class="header-anchor">#</a> 编译策略</h2> <p>多个源码文件的项目，编译时需要所有文件一起编译。哪怕只是修改了一行，也需要从头编译，非常耗费时间。</p> <p>为了节省时间，通常的做法是将编译拆分成两个步骤。第一步，使用 GCC 的<code>-c</code>参数，将每个源码文件单独编译为对象文件（object file）。第二步，将所有对象文件链接在一起，合并生成一个二进制可执行文件。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ gcc -c foo.c <span class="token comment"># 生成 foo.o</span>
$ gcc -c bar.c <span class="token comment"># 生成 bar.o</span>

<span class="token comment"># 更省事的写法</span>
$ gcc -c *.c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>上面命令为源码文件<code>foo.c</code>和<code>bar.c</code>，分别生成对象文件<code>foo.o</code>和<code>bar.o</code>。</p> <p>对象文件不是可执行文件，只是编译过程中的一个阶段性产物，文件名与源码文件相同，但是后缀名变成了<code>.o</code>。</p> <p>得到所有的对象文件以后，再次使用<code>gcc</code>命令，将它们通过链接，合并生成一个可执行文件。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ gcc -o foo foo.o bar.o

<span class="token comment"># 更省事的写法</span>
$ gcc -o foo *.o
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><p>以后，修改了哪一个源文件，就将这个文件重新编译成对象文件，其他文件不用重新编译，可以继续使用原来的对象文件，最后再将所有对象文件重新链接一次就可以了。由于链接的耗时大大短于编译，这样做就节省了大量时间。</p> <h2 id="make-命令"><a href="#make-命令" class="header-anchor">#</a> make 命令</h2> <p>大型项目的编译，如果全部手动完成，是非常麻烦的，容易出错。一般会使用专门的自动化编译工具，比如 make。</p> <p>make 是一个命令行工具，使用时会自动在当前目录下搜索配置文件 makefile（也可以写成 Makefile）。该文件定义了所有的编译规则，每个编译规则对应一个编译产物。为了得到这个编译产物，它需要知道两件事。</p> <ul><li>依赖项（生成该编译产物，需要用到哪些文件）</li> <li>生成命令（生成该编译产物的命令）</li></ul> <p>比如，对象文件<code>foo.o</code>是一个编译产物，它的依赖项是<code>foo.c</code>，生成命令是<code>gcc -c foo.c</code>。对应的编译规则如下：</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>foo<span class="token punctuation">.</span>o<span class="token operator">:</span> foo<span class="token punctuation">.</span>c
  gcc <span class="token operator">-</span>c foo<span class="token punctuation">.</span>c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>上面示例中，编译规则由两行组成。第一行首先是编译产物，冒号后面是它的依赖项，第二行则是生成命令。</p> <p>注意，第二行的缩进必须使用 Tab 键，如果使用空格键会报错。</p> <p>完整的配置文件 makefile 由多个编译规则组成，可能是下面的样子。</p> <div class="language-c line-numbers-mode"><pre class="language-c"><code>foo<span class="token operator">:</span> foo<span class="token punctuation">.</span>o bar<span class="token punctuation">.</span>o
  gcc <span class="token operator">-</span>o foo foo<span class="token punctuation">.</span>o bar<span class="token punctuation">.</span>o

foo<span class="token punctuation">.</span>o<span class="token operator">:</span> bar<span class="token punctuation">.</span>h foo<span class="token punctuation">.</span>c
  gcc <span class="token operator">-</span>c foo<span class="token punctuation">.</span>c

bar<span class="token punctuation">.</span>o<span class="token operator">:</span> bar<span class="token punctuation">.</span>h bar<span class="token punctuation">.</span>c
  gcc <span class="token operator">-</span>c bar<span class="token punctuation">.</span>c
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>上面是 makefile 的一个示例文件。它包含三个编译规则，对应三个编译产物（<code>foo.o</code>、<code>bar.o</code>和<code>foo</code>），每个编译规则之间使用空行分隔。</p> <p>有了 makefile，编译时，只要在 make 命令后面指定编译目标（编译产物的名字），就会自动调用对应的编译规则。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span> foo.o

<span class="token comment"># or</span>
$ <span class="token function">make</span> bar.o

<span class="token comment"># or</span>
$ <span class="token function">make</span> foo
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>上面示例中，make 命令会根据不同的命令，生成不同的编译产物。</p> <p>如果省略了编译目标，<code>make</code>命令会执行第一条编译规则，构建相应的产物。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>$ <span class="token function">make</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>上面示例中，<code>make</code>后面没有编译目标，所以会执行 makefile 的第一条编译规则，本例是<code>make foo</code>。由于用户期望执行<code>make</code>后得到最终的可执行文件，所以建议总是把最终可执行文件的编译规则，放在 makefile 文件的第一条。makefile 本身对编译规则没有顺序要求。</p> <p>make 命令的强大之处在于，它不是每次执行命令，都会进行编译，而是会检查是否有必要重新编译。具体方法是，通过检查每个源码文件的时间戳，确定在上次编译之后，哪些文件发生过变动。然后，重新编译那些受到影响的编译产物（即编译产物直接或间接依赖于那些发生变动的源码文件），不受影响的编译产物，就不会重新编译。</p> <p>举例来说，上次编译之后，修改了<code>foo.c</code>，没有修改<code>bar.c</code>和<code>bar.h</code>。于是，重新运行<code>make foo</code>命令时，Make 就会发现<code>bar.c</code>和<code>bar.h</code>没有变动过，因此不用重新编译<code>bar.o</code>，只需要重新编译<code>foo.o</code>。有了新的<code>foo.o</code>以后，再跟<code>bar.o</code>一起，重新编译成新的可执行文件<code>foo</code>。</p> <p>Make 这样设计的最大好处，就是自动处理编译过程，只重新编译变动过的文件，因此大大节省了时间。</p> <!----></div></div> <!----> <div class="page-edit"><div class="edit-link"><a href="https://github.com/Richard-LiSR/Vue_blog/edit/master/docs/02.技术/10.编程语言/01.C语言教程/19.多文件项目.md" target="_blank" rel="noopener noreferrer">在Github中编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2021-09-27 15:06:53</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/vuepress_blog/pages/dd8b65/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">19、变量说明符</div></a> <a href="/vuepress_blog/pages/f9b963/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">21、命令行环境</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/vuepress_blog/pages/dd8b65/" class="prev">19、变量说明符</a></span> <span class="next"><a href="/vuepress_blog/pages/f9b963/">21、命令行环境</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/vuepress_blog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/vuepress_blog/pages/10f247/"><div>你好世界</div></a> <span>09-20</span></dt></dl><dl><dd>02</dd> <dt><a href="/vuepress_blog/pages/0b36bc/"><div>1、基本介绍</div></a> <span>09-19</span></dt></dl><dl><dd>03</dd> <dt><a href="/vuepress_blog/pages/980fa1/"><div>2、基本语法</div></a> <span>09-19</span></dt></dl> <dl><dd></dd> <dt><a href="/vuepress_blog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="mailto:2837657164@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/Richard-LiSR" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://cdn.jsdelivr.net/gh/Richard-LiSR/PicBed/blog_img/weixin.jpg" title="加我微信" target="_blank" class="iconfont icon-weixin"></a><a href="https://cdn.jsdelivr.net/gh/Richard-LiSR/PicBed/blog_img/qq.jpg" title="加我QQ" target="_blank" class="iconfont icon-QQ"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2021
    <span>MIT | <a href="https://github.com/Richard-LiSR/Vue_blog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <div class="body-bg" style="background:url() center center / cover no-repeat;opacity:0.5;"></div> <!----> <!----></div><div class="global-ui"><div id="live2d-widget" class="live2d-widget-container" style="position:fixed;left:80px;bottom:-20px;width:135px;height:300px;z-index:99999;opacity:1;pointer-events:none;"><canvas id="live2d_canvas" width="135" height="300" class="live2d_canvas" style="position:absolute;left:0px;top:0px;width:135px;height:300px;"></canvas></div><!----></div></div>
    <script src="/vuepress_blog/assets/js/app.ba4d12ab.js" defer></script><script src="/vuepress_blog/assets/js/3.5f960c14.js" defer></script><script src="/vuepress_blog/assets/js/30.6989e660.js" defer></script><script src="/vuepress_blog/assets/js/5.8ee74237.js" defer></script>
  </body>
</html>